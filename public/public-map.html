<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DrainTrack - Interactive Inventory Map</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome for icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <!-- Leaflet CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.3/leaflet.css" rel="stylesheet">
  <!-- Leaflet MarkerCluster CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/MarkerCluster.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/MarkerCluster.Default.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css"
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <i class="fas fa-water"></i>
        DrainTrack
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" title="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="home.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="#">Map</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Help</a>
          </li>
        </ul>
        </div>
      </div>
    </div>
  </nav>

  <div class="full-screen-container">
   

    <div class="map-container">
      <!-- Map Element -->
      <div id="map"></div>
      
      <!-- Search and Filter Overlay -->
      <div class="map-overlay collapsed" id="filter-overlay">
        <button type="button" class="collapse-btn" id="collapse-overlay" title="Collapse Overlay">
          <i class="fas fa-chevron-right"></i> 
        </button>
        
        <h4 class="mb-3">Map Controls</h4>
        
        <!-- Search Box -->
        <div class="search-box mb-4">
          <i class="fas fa-search"></i>
          <input type="text" class="form-control" id="search-input" placeholder="Search drainage points...">
        </div>
        
        <!-- Filters -->
        <div class="filter-control">
          <h5><i class="fas fa-filter me-2"></i> Filters</h5>
          
          <div class="mb-3">
            <label class="form-label">Drainage Type</label>
            <div>
              <span class="filter-badge active" data-filter="all">All</span>
              <span class="filter-badge" data-filter="concrete">Concrete</span>
              <span class="filter-badge" data-filter="earth">Earth</span>
              <span class="filter-badge" data-filter="box-culvert">Box Culvert</span>
              <span class="filter-badge" data-filter="pipe">Pipe</span>
            </div>
          </div>
          
          <div class="mb-3">
            <label class="form-label">Status</label>
            <div>
              <span class="filter-badge active" data-filter="all">All</span>
              <span class="filter-badge" data-filter="good">Good</span>
              <span class="filter-badge" data-filter="needs-maintenance">Needs Maintenance</span>
              <span class="filter-badge" data-filter="critical">Critical</span>
            </div>
          </div>
          
          <div class="mb-3">
            <label class="form-label">Depth Range</label>
            <div class="d-flex align-items-center">
              <label for="depth-range" class="form-label">Adjust Depth Range</label>
              <input type="range" class="form-range" id="depth-range" min="0" max="10" step="0.5">
              <span class="ms-2" id="depth-value">0-10m</span>
            </div>
          </div>
        </div>
        
        <!-- Legend -->
        <div class="legend">
          <h5><i class="fas fa-info-circle me-2"></i> Legend</h5>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #28a745;"></div>
            <span>Good Condition</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #ffc107;"></div>
            <span>Needs Maintenance</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #dc3545;"></div>
            <span>Critical Condition</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #17a2b8;"></div>
            <span>Flood-prone Area</span>
          </div>
        </div>
        
        <!-- Recent Activity -->
        
        </div>
      </div>
      
      
      
      <!-- Map Controls -->
      <div class="controls-container">
        <button class="map-control-btn" id="zoom-in-btn" title="Zoom In">
          <i class="fas fa-plus"></i>
        </button>
        <button class="map-control-btn" id="zoom-out-btn" title="Zoom Out">
          <i class="fas fa-minus"></i>
        </button>
        <button class="map-control-btn" id="locate-me-btn" title="My Location">
          <i class="fas fa-location-arrow"></i>
        </button>
        <button class="map-control-btn" id="full-extent-btn" title="Full Extent">
          <i class="fas fa-expand"></i>
        </button>
        <button class="map-control-btn" id="toggle-layers-btn" title="Toggle Layers">
          <i class="fas fa-layer-group"></i>
        </button>
      </div>
      
      <!-- Flood Report Button -->
      <button class="btn btn-danger flood-report-btn">
        <i class="fas fa-exclamation-triangle"></i> Report Flooding
      </button>

      <div class="point-control">
        
        
      </div>
    </div>

    
    
  </div>
  
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading-overlay">
    <div class="spinner-container">
      <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
      <div class="mt-3">Loading map data...</div>
    </div>
  </div>

  <!-- Add Point Modal -->
 <!-- <div class="modal fade" id="addPointModal" tabindex="-1" aria-labelledby="addPointModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addPointModalLabel">Add New Drainage Point</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="add-point-form">
            <div class="mb-3">
              <label for="point-name" class="form-label">Name</label>
              <input type="text" class="form-control" id="point-name" required>
            </div>
            <div class="mb-3">
              <label for="point-type" class="form-label">Type</label>
              <select class="form-select" id="point-type" required>
                <option value="">Select type</option>
                <option value="Concrete Drain">Concrete Drain</option>
                <option value="Earth Drain">Earth Drain</option>
                <option value="Box Culvert">Box Culvert</option>
                <option value="Pipe Drain">Pipe Drain</option>
              </select>
            </div>
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="point-depth" class="form-label">Depth (m)</label>
                  <input type="number" class="form-control" id="point-depth" step="0.1" min="0">
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="point-status" class="form-label">Status</label>
                  <select class="form-select" id="point-status" required>
                    <option value="Good">Good</option>
                    <option value="Needs Maintenance">Needs Maintenance</option>
                    <option value="Critical">Critical</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="point-il" class="form-label">Invert Level</label>
                  <input type="text" class="form-control" id="point-il">
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="point-rl" class="form-label">Reduced Level</label>
                  <input type="text" class="form-control" id="point-rl">
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="point-coordinates" class="form-label">Coordinates</label>
              <div class="input-group">
                <input type="text" class="form-control" id="point-lat" placeholder="Latitude" readonly>
                <input type="text" class="form-control" id="point-lng" placeholder="Longitude" readonly>
                <button class="btn btn-outline-secondary" type="button" id="pick-location-btn">
                  <i class="fas fa-map-marker-alt"></i>
                </button>
              </div>
              <div class="form-text">Click "Pick Location" to select a point on the map</div>
            </div>
            <div class="mb-3">
              <label for="point-description" class="form-label">Description</label>
              <textarea class="form-control" id="point-description" rows="3"></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Upload Images</label>
              <input type="file" class="form-control" id="point-images" multiple accept="image/*">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" id="save-point-btn">Save Point</button>
        </div>
      </div>
    </div>
  </div>
-->
  <!-- Flood Report Modal -->
  <div class="modal fade" id="floodReportModal" tabindex="-1" aria-labelledby="floodReportModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-danger text-white">
          <h5 class="modal-title" id="floodReportModalLabel">Report Flooding</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="alert alert-warning">
            <i class="fas fa-info-circle me-2"></i> Please provide as much detail as possible to help us respond quickly.
          </div>
          <form id="flood-report-form">
            <div class="mb-3">
              <label for="flood-location" class="form-label">Location</label>
              <div class="input-group">
                <input type="text" class="form-control" id="flood-location-input" placeholder="Address or description" required>
                <button class="btn btn-outline-secondary" type="button" id="flood-pick-location-btn">
                  <i class="fas fa-map-marker-alt"></i>
                </button>
              </div>
              <div class="form-text">Click the map marker button to select a location on the map</div>
            </div>
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="flood-severity" class="form-label">Severity</label>
                  <select class="form-select" id="flood-severity" required>
                    <option value="">Select severity</option>
                    <option value="Minor">Minor - Small puddles</option>
                    <option value="Moderate">Moderate - Road partially flooded</option>
                    <option value="Severe">Severe - Road impassable</option>
                    <option value="Extreme">Extreme - Property flooding</option>
                  </select>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="flood-water-depth" class="form-label">Approximate Water Depth</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="flood-water-depth" min="0" step="0.1">
                    <span class="input-group-text">cm</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="flood-description" class="form-label">Description</label>
              <textarea class="form-control" id="flood-description" rows="3" required></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Upload Photos</label>
              <input type="file" class="form-control" id="flood-images" multiple accept="image/*">
            </div>
            <div class="mb-3">
              <label for="reporter-contact" class="form-label">Your Contact Info (optional)</label>
              <input type="text" class="form-control" id="reporter-contact" placeholder="Phone or email">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" id="submit-flood-report-btn">Submit Report</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Layer Control Modal (continuation) -->
<div class="modal fade" id="layerControlModal" tabindex="-1" aria-labelledby="layerControlModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="layerControlModalLabel">Map Layers</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="form-check form-switch mb-2">
          <input class="form-check-input" type="checkbox" id="layer-drainage" checked>
          <label class="form-check-label" for="layer-drainage">Drainage Points</label>
        </div>
        <div class="form-check form-switch mb-2">
          <input class="form-check-input" type="checkbox" id="layer-flood-prone" checked>
          <label class="form-check-label" for="layer-flood-prone">Flood-prone Areas</label>
        </div>
        <div class="form-check form-switch mb-2">
          <input class="form-check-input" type="checkbox" id="layer-maintenance">
          <label class="form-check-label" for="layer-maintenance">Maintenance Routes</label>
        </div>
        <div class="form-check form-switch mb-2">
          <input class="form-check-input" type="checkbox" id="layer-catchments">
          <label class="form-check-label" for="layer-catchments">Catchment Areas</label>
        </div>
        <div class="form-check form-switch mb-2">
          <input class="form-check-input" type="checkbox" id="layer-rainfall">
          <label class="form-check-label" for="layer-rainfall">Rainfall Intensity</label>
        </div>
        <hr />
        <h6>Base Maps</h6>
        <div class="form-check mb-2">
          <input class="form-check-input" type="radio" name="basemap" id="basemap-street" checked>
          <label class="form-check-label" for="basemap-street">Street Map</label>
        </div>
        <div class="form-check mb-2">
          <input class="form-check-input" type="radio" name="basemap" id="basemap-satellite">
          <label class="form-check-label" for="basemap-satellite">Satellite Imagery</label>
        </div>
        <div class="form-check mb-2">
          <input class="form-check-input" type="radio" name="basemap" id="basemap-terrain">
          <label class="form-check-label" for="basemap-terrain">Terrain</label>
        </div>
        <div class="form-check mb-2">
          <input class="form-check-input" type="radio" name="basemap" id="basemap-topo">
          <label class="form-check-label" for="basemap-topo">Topographic</label>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="reset-layers-btn">Reset to Default</button>
      </div>
    </div>
  </div>
</div>

<!-- Point Details Modal -->
<div class="modal fade" id="pointDetailsModal" tabindex="-1" aria-labelledby="pointDetailsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="pointDetailsModalLabel">Drainage Point Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-6">
            <div class="card mb-3">
              <div class="card-header bg-primary text-white">
                <h5 class="mb-0">General Information</h5>
              </div>
              <div class="card-body">
                <table class="table table-bordered">
                  <tbody id="point-details-table">
                    <!-- Will be populated dynamically -->
                  </tbody>
                </table>
              </div>
            </div>
            
            <div class="card mb-3">
              <div class="card-header bg-primary text-white">
                <h5 class="mb-0">Maintenance History</h5>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-sm table-hover" id="maintenance-history-table">
                    <!-- Will be populated dynamically -->
                  </table>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="card mb-3">
              <div class="card-header bg-primary text-white">
                <h5 class="mb-0">Media Gallery</h5>
              </div>
              <div class="card-body">
                <div id="point-image-gallery" class="media-gallery">
                  <!-- Will be populated dynamically -->
                </div>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header bg-primary text-white">
                <h5 class="mb-0">Actions</h5>
              </div>
              <div class="card-body">
                <div class="d-grid gap-2">
                  <button class="btn btn-outline-primary" id="schedule-inspection-btn">
                    <i class="fas fa-clipboard-check me-2"></i>Schedule Inspection
                  </button>
                  <button class="btn btn-outline-primary" id="maintenance-request-btn">
                    <i class="fas fa-tools me-2"></i>Request Maintenance
                  </button>
                  <button class="btn btn-outline-secondary" id="download-report-btn">
                    <i class="fas fa-file-download me-2"></i>Download Report
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="edit-point-btn">Edit Point</button>
        <button type="button" class="btn btn-danger" id="delete-point-btn">Delete Point</button>
      </div>
    </div>
  </div>
</div>

<!-- Export Data Modal -->
<div class="modal fade" id="exportModal" tabindex="-1" aria-labelledby="exportModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exportModalLabel">Export Data</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="export-format" class="form-label">Export Format</label>
          <select class="form-select" id="export-format">
            <option value="csv">CSV</option>
            <option value="xlsx">Excel (XLSX)</option>
            <option value="geojson">GeoJSON</option>
            <option value="shp">Shapefile</option>
            <option value="pdf">PDF Report</option>
          </select>
        </div>
        
        <div class="mb-3">
          <label class="form-label">Include Data</label>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="export-drainage" checked>
            <label class="form-check-label" for="export-drainage">Drainage Points</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="export-flood-prone" checked>
            <label class="form-check-label" for="export-flood-prone">Flood-prone Areas</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="export-maintenance">
            <label class="form-check-label" for="export-maintenance">Maintenance Records</label>
          </div>
        </div>
        
        <div class="mb-3">
          <label class="form-label">Filter Options</label>
          <div class="row">
            <div class="col-md-6">
              <select class="form-select mb-2" id="export-filter-type">
                <option value="all">All Types</option>
                <option value="concrete">Concrete Drains</option>
                <option value="earth">Earth Drains</option>
                <option value="box-culvert">Box Culverts</option>
                <option value="pipe">Pipe Drains</option>
              </select>
            </div>
            <div class="col-md-6">
              <select class="form-select mb-2" id="export-filter-status">
                <option value="all">All Statuses</option>
                <option value="good">Good</option>
                <option value="needs-maintenance">Needs Maintenance</option>
                <option value="critical">Critical</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="confirm-export-btn">Export</button>
      </div>
    </div>
  </div>
</div>

<!-- Scripts section would follow here -->
<!-- Bootstrap Bundle with Popper -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<!-- Leaflet JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.3/leaflet.js"></script>
<!-- Leaflet MarkerCluster JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/leaflet.markercluster.js"></script>
<!-- Your custom JS file would be linked here -->
 <script src="js/public-map.js"></script>
</body>
</html>